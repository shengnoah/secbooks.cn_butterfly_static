{"title":"微博API发送微博","uid":"a7777311d1e67a84d45b8c65389d0ce5","slug":"old_topic/2016-09-17-276","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-16T11:44:51.870Z","comments":true,"path":"api/articles/old_topic/2016-09-17-276.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"content":"<p>使用微博的API和SDK的其中的关键一步是取得token. 而取得token是需要通过oauth2认证才可以得到。</p>\n<p>下面是一段取得token的代码逻辑：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">APP_KEY =<span class=\"string\">&#x27;012345678&#x27;</span></span><br><span class=\"line\">APP_SECRET = <span class=\"string\">&#x27;01234567891011121314151617181920&#x27;</span></span><br><span class=\"line\">CALL_BACK= <span class=\"string\">&#x27;http://www.lua.ren/callback&#x27;</span></span><br><span class=\"line\">client = weibo.APIClient(APP_KEY, APP_SECRET, CALL_BACK)</span><br><span class=\"line\">auth_url = client.get_authorize_url()</span><br><span class=\"line\">login_url = <span class=\"string\">&#x27;https://api.weibo.com/oauth2/authorize&#x27;</span></span><br><span class=\"line\">params = urllib.urlencode(&#123;<span class=\"string\">&#x27;action&#x27;</span> : <span class=\"string\">&#x27;submit&#x27;</span>,<span class=\"string\">&#x27;response_type&#x27;</span> : <span class=\"string\">&#x27;code&#x27;</span>,<span class=\"string\">&#x27;redirect_uri&#x27;</span> : CALL_BACK,<span class=\"string\">&#x27;client_id&#x27;</span> : APP_KEY,<span class=\"string\">&#x27;userId&#x27;</span> : <span class=\"string\">&#x27;userid&#x27;</span>,<span class=\"string\">&#x27;passwd&#x27;</span> : <span class=\"string\">&#x27;password&#x27;</span>,&#125;)</span><br><span class=\"line\">url = client.get_authorize_url()</span><br></pre></td></tr></table></figure>\n<p>APP_KEY各APP_SECRET是申请OPEN API时被分配的，CALL_BACK是在微博开放API后台自定义的，当你用浏览器访问client.get_authorize_url()函数返回的url时，微博开发接口会调用这个callback的url，调用中包含了code这个字段，通过code可以取得token。</p>\n<p>只有取得了token之后，才可以正常的访问微博的API。</p>\n<p>代码如下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">r = client.request_access_token(code)</span><br><span class=\"line\">client.set_access_token(r.access_token, r.expires_in)</span><br></pre></td></tr></table></figure>\n<p>发送微博代码：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">content = <span class=\"string\">&#x27;test&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> content:</span><br><span class=\"line\">    client.statuses.update.post(status=content)</span><br></pre></td></tr></table></figure>","text":"使用微博的API和SDK的其中的关键一步是取得token. 而取得token是需要通过oauth2认证才可以得到。 下面是一段取得token的代码逻辑： 123456789APP_KEY ='012345678'APP_SECRET = '01234567891011121314...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Lua获取网络时间","uid":"ac0402ecf46546727fdbca4cc5ec0bdf","slug":"old_topic/2016-09-17-275","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-16T11:44:51.869Z","comments":true,"path":"api/articles/old_topic/2016-09-17-275.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"作者：ani_di 版权所有，转载务必保留此链接 http://blog.csdn.net/ani_di Lua获取网络时间 网络授时服务是一些网络上的时间服务器提供的时间，一般用于本地时钟同步。 授时服务有很多种，一般我们选择RFC-868。这个协议的工作流程是：（S代表Ser...","link":"","photos":[],"count_time":{"symbolsCount":"4.4k","symbolsTime":"4 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Tail Call 到底有啥用？","uid":"d50433282a5b8a29764977173d70c1a2","slug":"old_topic/2016-09-17-279","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-16T11:44:51.870Z","comments":true,"path":"api/articles/old_topic/2016-09-17-279.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":[],"text":"作者：ms2008 整理编辑：糖果 在聊今天这个话题之前，我们需要知道什么叫 tail call。先来看下，lua 程序设计是怎么定义的： 尾调用是一种类似在函数结尾的 goto 调用，当函数最后一个动作是调用另外一个函数时，我们称这种调用尾调用。例如： function f(x...","link":"","photos":[],"count_time":{"symbolsCount":979,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}