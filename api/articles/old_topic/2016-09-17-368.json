{"title":"MoonScript for GrayLog","uid":"bace4a0f855ab931a94c6323590dcc00","slug":"old_topic/2016-09-17-368","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-16T11:44:51.888Z","comments":true,"path":"api/articles/old_topic/2016-09-17-368.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"content":"<p>GrayLog REST API Wrapper for Moonscript</p>\n<p>此程序是Graylog REST对外提供的API的一个Moonscript的Wrapper封装，把REST接口提供的数据服务，变成通过函数调用的方式取得相应REST接口返回的数据。</p>\n<p>下面是一个实际的基于Lapis框架程序中调用此SDK的例子：</p>\n<figure class=\"highlight lua\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class App extends lapis.Application</span><br><span class=\"line\">  <span class=\"string\">&quot;/testcase&quot;</span>: =&gt;</span><br><span class=\"line\">    <span class=\"comment\">--准备对应REST的输入参数，如果相应该有的项目没有设定会输出NG原因。</span></span><br><span class=\"line\">    param_data= &#123;</span><br><span class=\"line\">        fields:<span class=\"string\">&#x27;username&#x27;</span>,</span><br><span class=\"line\">        limit:<span class=\"number\">3</span>,</span><br><span class=\"line\">        query:<span class=\"string\">&#x27;*&#x27;</span>,</span><br><span class=\"line\">        from: <span class=\"string\">&#x27;2017-01-05 00:00:00&#x27;</span>,</span><br><span class=\"line\">        to:<span class=\"string\">&#x27;2017-01-06 00:00:00&#x27;</span>,</span><br><span class=\"line\">        filter:<span class=\"string\">&#x27;streams&#x27;</span>..<span class=\"string\">&#x27;:&#x27;</span>..<span class=\"string\">&#x27;673b1666ca624a6231a460fa&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">--进行鉴权信息设定</span></span><br><span class=\"line\">    url  = GMoonSDK\\auth <span class=\"string\">&#x27;supervisor&#x27;</span>, <span class=\"string\">&#x27;password&#x27;</span>, <span class=\"string\">&#x27;127.0.0.1&#x27;</span>, <span class=\"string\">&#x27;12600&#x27;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">--调用对应&#x27;TYPE&#x27;相对应的REST服务，返回结果。</span></span><br><span class=\"line\">    ret = GMoonSDK\\dealStream <span class=\"string\">&#x27;s_ua&#x27;</span>, param_data</span><br><span class=\"line\">    ret</span><br><span class=\"line\">```    </span><br><span class=\"line\">上文提到 ‘TYPE’， 其实就是对Endpoints的一种编号，基本上和GrayLog REST API是一对一关系。</span><br><span class=\"line\"></span><br><span class=\"line\">```lua</span><br><span class=\"line\">    endpoints: &#123;</span><br><span class=\"line\">        <span class=\"string\">&#x27;s_uat&#x27;</span>:&#123;<span class=\"string\">&#x27;/search/universal/absolute/terms&#x27;</span>:&#123;<span class=\"string\">&#x27;field&#x27;</span>, <span class=\"string\">&#x27;query&#x27;</span>, <span class=\"string\">&#x27;from&#x27;</span>, <span class=\"string\">&#x27;to&#x27;</span>, <span class=\"string\">&#x27;limit&#x27;</span>&#125; &#125;</span><br><span class=\"line\">        <span class=\"string\">&#x27;s_ua&#x27;</span>:&#123;<span class=\"string\">&#x27;/search/universal/absolute&#x27;</span>:&#123;<span class=\"string\">&#x27;fields&#x27;</span>, <span class=\"string\">&#x27;query&#x27;</span>, <span class=\"string\">&#x27;from&#x27;</span>, <span class=\"string\">&#x27;to&#x27;</span>, <span class=\"string\">&#x27;limit&#x27;</span>&#125; &#125;</span><br><span class=\"line\">        <span class=\"string\">&#x27;s_urt&#x27;</span>:&#123;<span class=\"string\">&#x27;/search/universal/relative/terms&#x27;</span>:&#123;<span class=\"string\">&#x27;field&#x27;</span>, <span class=\"string\">&#x27;query&#x27;</span>, <span class=\"string\">&#x27;range&#x27;</span>&#125; &#125;</span><br><span class=\"line\">        <span class=\"string\">&#x27;s_ut&#x27;</span>:&#123;<span class=\"string\">&#x27;/search/universal/relative&#x27;</span>:&#123;<span class=\"string\">&#x27;fields&#x27;</span>, <span class=\"string\">&#x27;query&#x27;</span>, <span class=\"string\">&#x27;range&#x27;</span>&#125; &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p>理论上说，可以个修改以上的数据结构，对应各种REST API的服封装(GET),只要知道对应URL与可接收的参数列表。</p>\n","text":"GrayLog REST API Wrapper for Moonscript 此程序是Graylog REST对外提供的API的一个Moonscript的Wrapper封装，把REST接口提供的数据服务，变成通过函数调用的方式取得相应REST接口返回的数据。 下面是一个实际的基...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"MoonScript's Object","uid":"f17567ac35ebb144b8a5d3dffefc17d8","slug":"old_topic/2016-09-17-367","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-16T11:44:51.888Z","comments":true,"path":"api/articles/old_topic/2016-09-17-367.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"作者：糖果 Coffescript是一种中间的脚本，可以把这种脚本翻译成JavaScript。而MoonScript，是可以翻译成lua语言的中间脚本。 本文简单的介绍的： 如何在VIM中，实现MoonScript语法高亮。 如何简单的编译MoonScript脚本。 MoonSc...","link":"","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Moonscript与HTML模板","uid":"ea8283997977848c6827a1a83f28911d","slug":"old_topic/2016-09-17-366","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-16T11:44:51.888Z","comments":true,"path":"api/articles/old_topic/2016-09-17-366.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"作者：糖果 Moonscript与HTML模板 Lapis框架可以用Moonscript直接编程，Moonscript可以将需要模板系统对于的网页输出，一揽子的都在Moonscript中用代码实现，可以看leaof.net/lapis下最典型的官方例子，其实DB的相关操作也可以在...","link":"","photos":[],"count_time":{"symbolsCount":"2.6k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}